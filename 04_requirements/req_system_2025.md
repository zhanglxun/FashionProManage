# 系统管理模块需求文档

## 需求文档模板格式

### 模块概述
- **模块名称**：[模块中文名称]
- **模块编码**：[模块英文编码]
- **业务价值**：[该模块解决的核心业务问题]
- **目标用户**：[主要使用该模块的用户角色]
- **优先级**：[高/中/低]

### 功能需求
#### 子功能1：[功能名称]
- **功能描述**：[详细功能说明]
- **业务规则**：[相关业务规则和约束]
- **操作流程**：[主要操作步骤]
- **数据字段**：[涉及的主要数据字段]
- **界面要求**：[界面设计要求]
- **权限控制**：[权限要求]

#### 子功能2：[功能名称]
- **功能描述**：[详细功能说明]
- **业务规则**：[相关业务规则和约束]
- **操作流程**：[主要操作步骤]
- **数据字段**：[涉及的主要数据字段]
- **界面要求**：[界面设计要求]
- **权限控制**：[权限要求]

### 非功能需求
- **性能要求**：[响应时间、并发量等]
- **安全要求**：[数据安全、访问控制等]
- **兼容性要求**：[浏览器、设备兼容性等]
- **可用性要求**：[易用性、可访问性等]

### 数据模型
- **主要数据表**：[涉及的核心数据表]
- **数据关系**：[表之间的关联关系]
- **数据约束**：[数据完整性约束]

---

## 系统管理模块详细需求

### 模块概述
- **模块名称**：系统管理
- **模块编码**：system
- **业务价值**：为服装生产管理系统提供基础的用户管理、权限控制、系统配置和日志监控功能，确保系统安全稳定运行
- **目标用户**：系统管理员、企业管理员
- **优先级**：高

### 功能需求

#### 1. 账号管理
##### 1.1 普通用户账号管理
- **功能描述**：管理系统中的普通用户账号，包括用户注册、信息维护、状态管理等功能
- **业务规则**：
  - 用户账号唯一性校验
  - 手机号/邮箱格式验证
  - 密码强度要求（至少8位，包含字母和数字）
  - 用户状态：1-激活，2-注销
- **操作流程**：
  1. 管理员创建用户账号
  2. 用户通过手机号/邮箱验证激活
  3. 用户完善个人信息
  4. 分配角色权限
- **数据字段**：
  - 基本信息：id, account, pwd, chinese_name, nickname, email, mobile
  - 个人资料：sex, birthday, nationality, education, career
  - 地址信息：province, cities, address_province, address_city, address_area
  - 系统信息：status, register_time, role_id, user_type
- **界面要求**：
  - 用户列表页面，支持搜索、筛选、分页
  - 用户详情页面，支持信息编辑
  - 用户创建/编辑表单，字段验证提示
- **权限控制**：仅系统管理员可管理用户账号

##### 1.2 平台用户账号管理
- **功能描述**：管理平台级用户账号，包括企业管理员、系统管理员等高级用户
- **业务规则**：
  - 平台用户具有更高权限
  - 支持多角色分配
  - 登录客户端限制
- **操作流程**：
  1. 系统管理员创建平台用户
  2. 分配平台级角色
  3. 设置登录客户端权限
- **数据字段**：
  - 继承普通用户字段
  - 平台特有：login_client, hospital_role_id, enterprise_user_id
- **界面要求**：
  - 平台用户管理界面
  - 角色分配界面
  - 客户端权限配置
- **权限控制**：仅超级管理员可管理平台用户

#### 2. 权限管理
##### 2.1 角色管理
- **功能描述**：管理系统角色，定义不同角色的权限范围
- **业务规则**：
  - 角色名称唯一性
  - 角色类型通过字典配置
  - 支持角色继承关系
- **操作流程**：
  1. 创建角色
  2. 配置角色权限
  3. 分配用户到角色
- **数据字段**：
  - 角色信息：id, name, type, description
  - 系统标识：login_client, hospital_id, hospital_admin_flag
- **界面要求**：
  - 角色列表管理
  - 角色权限配置树形界面
  - 用户角色分配界面
- **权限控制**：系统管理员可管理角色

##### 2.2 菜单管理
- **功能描述**：管理系统菜单结构，配置菜单层级和访问权限
- **业务规则**：
  - 支持多级菜单结构
  - 菜单排序功能
  - 菜单状态控制
- **操作流程**：
  1. 创建菜单项
  2. 设置菜单层级关系
  3. 配置菜单权限
- **数据字段**：
  - 菜单信息：id, name, url, icon_class, description
  - 层级关系：parent_id, sort_id
  - 系统标识：function_type, system_code
- **界面要求**：
  - 树形菜单管理界面
  - 拖拽排序功能
  - 菜单权限配置
- **权限控制**：系统管理员可管理菜单

##### 2.3 权限配置
- **功能描述**：配置细粒度的功能权限，控制用户对具体功能的访问
- **业务规则**：
  - 基于角色的权限控制（RBAC）
  - 支持菜单权限和功能权限
  - 权限继承机制
- **操作流程**：
  1. 为角色分配菜单权限
  2. 配置功能操作权限
  3. 设置权限继承关系
- **数据字段**：
  - 权限关系：s_role_menu, s_page_role
  - 资源信息：s_resource
- **界面要求**：
  - 权限配置矩阵界面
  - 权限继承关系图
  - 权限预览功能
- **权限控制**：系统管理员可配置权限

#### 3. 字典管理
##### 3.1 系统字典配置
- **功能描述**：管理系统中的各类字典数据，支持多语言配置
- **业务规则**：
  - 字典分类管理
  - 支持多级字典结构
  - 字典状态控制
  - 支持国际化配置
- **操作流程**：
  1. 创建字典分类
  2. 添加字典项
  3. 配置多语言
- **数据字段**：
  - 字典信息：id, name, value, description
  - 层级关系：parent_id, sort_id
  - 状态控制：status
  - 多语言：english (JSON)
- **界面要求**：
  - 树形字典管理界面
  - 字典项编辑表单
  - 多语言配置界面
- **权限控制**：系统管理员可管理字典

#### 4. 系统日志管理
##### 4.1 用户登录日志
- **功能描述**：记录用户登录信息，包括登录时间、设备信息、IP地址等
- **业务规则**：
  - 记录所有登录尝试
  - 区分成功和失败登录
  - 记录设备详细信息
- **操作流程**：
  1. 用户登录时自动记录
  2. 管理员查看登录日志
  3. 异常登录告警
- **数据字段**：
  - 登录信息：login_time, account, user_id, user_name
  - 设备信息：platform, device_name, resolution, app_version
  - 网络信息：ip_address, destination, mac
  - 状态信息：success_flag, failed_message
- **界面要求**：
  - 登录日志列表
  - 日志详情查看
  - 异常登录筛选
- **权限控制**：系统管理员可查看登录日志

##### 4.2 短信验证码日志
- **功能描述**：记录短信验证码发送和验证记录
- **业务规则**：
  - 记录验证码发送历史
  - 验证码有效期控制
  - 发送频率限制
- **操作流程**：
  1. 发送验证码时记录
  2. 验证时检查有效性
  3. 管理员查看发送记录
- **数据字段**：
  - 发送信息：mobile, verification, send_time, client_id
  - 验证信息：type, status
  - 网络信息：ip_address, destination
- **界面要求**：
  - 验证码日志列表
  - 发送统计报表
  - 异常发送筛选
- **权限控制**：系统管理员可查看验证码日志

##### 4.3 全局操作日志
- **功能描述**：记录系统中的重要操作，用于审计和问题追踪
- **业务规则**：
  - 记录关键业务操作
  - 包含操作人和操作时间
  - 支持操作回滚
- **操作流程**：
  1. 系统自动记录操作
  2. 管理员查看操作日志
  3. 异常操作告警
- **数据字段**：
  - 操作信息：operation, create_time, create_id
  - 操作结果：success_flag, failed_message
- **界面要求**：
  - 操作日志列表
  - 操作详情查看
  - 操作统计分析
- **权限控制**：系统管理员可查看操作日志

#### 5. 客户端管理
##### 5.1 客户端管理
- **功能描述**：管理系统客户端，控制不同客户端的访问权限
- **业务规则**：
  - 客户端唯一标识
  - 客户端状态控制
  - 访问权限配置
- **操作流程**：
  1. 注册客户端
  2. 配置访问权限
  3. 监控客户端状态
- **数据字段**：
  - 客户端信息：client_id, client_name, description
  - 状态信息：status, create_time
- **界面要求**：
  - 客户端列表管理
  - 客户端配置界面
  - 客户端状态监控
- **权限控制**：系统管理员可管理客户端

### 非功能需求
- **性能要求**：
  - 用户列表查询响应时间 < 2秒
  - 支持1000+并发用户
  - 日志查询响应时间 < 3秒
- **安全要求**：
  - 密码加密存储
  - 登录失败次数限制
  - 敏感操作二次验证
- **兼容性要求**：
  - 支持主流浏览器（Chrome、Firefox、Safari、Edge）
  - 支持移动端访问
- **可用性要求**：
  - 界面简洁直观
  - 操作步骤清晰
  - 错误提示友好

### 数据模型
- **主要数据表**：
  - s_users（用户表）
  - s_roles（角色表）
  - s_menu（菜单表）
  - s_user_role（用户角色关系表）
  - s_role_menu（角色菜单关系表）
  - s_resource（资源表）
  - s_dictionary（字典表）
  - s_user_login_log（登录日志表）
  - s_mobile_verification_log（验证码日志表）
- **数据关系**：
  - 用户与角色：多对多关系（通过s_user_role）
  - 角色与菜单：多对多关系（通过s_role_menu）
  - 菜单与资源：一对多关系
  - 字典：树形结构（通过parent_id）
- **数据约束**：
  - 用户账号唯一性
  - 角色名称唯一性
  - 菜单URL唯一性
  - 字典编码唯一性

